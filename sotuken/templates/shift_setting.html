<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <title>ã‚·ãƒ•ãƒˆè‡ªå‹•ç”Ÿæˆè¨­å®š</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/settings.css') }}">
  <style>
    /* ã‚¨ãƒªã‚¢ã”ã¨ã®ã‚«ãƒ¼ãƒ‰ãƒ‡ã‚¶ã‚¤ãƒ³ */
    .time-zone-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    .zone-card {
      background: #fff;
      border-radius: 10px;
      padding: 20px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
      border-top: 5px solid #ccc;
    }
    /* å„ã‚¨ãƒªã‚¢ã®è‰²åˆ†ã‘ */
    .zone-morning { border-color: #4caf50; } /* æœï¼šç·‘ */
    .zone-lunch   { border-color: #ff9800; } /* æ˜¼ï¼šã‚ªãƒ¬ãƒ³ã‚¸ */
    .zone-idle    { border-color: #9e9e9e; } /* 15æ™‚ï¼šã‚°ãƒ¬ãƒ¼ */
    .zone-night   { border-color: #3f51b5; } /* å¤œï¼šé’ */

    .zone-title { font-weight: bold; font-size: 1.2em; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
    .form-row { margin-bottom: 10px; }
    .form-row label { display: block; font-size: 0.9em; color: #666; margin-bottom: 3px; }
    .form-row input, .form-row select { width: 100%; padding: 8px; box-sizing: border-box; border: 1px solid #ddd; border-radius: 4px; }
    .add-btn { width: 100%; border: none; padding: 10px; color: white; font-weight: bold; border-radius: 4px; cursor: pointer; margin-top: 10px; }
    
    /* ãƒ†ãƒ¼ãƒ–ãƒ«ã®ãƒ‡ã‚¶ã‚¤ãƒ³ */
    .demand-list { background: #fff; padding: 20px; border-radius: 8px; }
    table { width: 100%; border-collapse: collapse; font-size: 0.9em; }
    th, td { border-bottom: 1px solid #eee; padding: 10px; text-align: left; }
    th { background: #f9f9f9; color: #555; }
  </style>
  <script src="{{ url_for('static', filename='js/shift_settings.js') }}"></script>
</head>
<body>
  <div class="menu-btn" id="menuBtn"><span></span><span></span><span></span></div>
  <nav class="side-menu" id="sideMenu">
    <ul>
      <li><a href="{{ url_for('makeshift.show_admin_shift') }}">å¸Œæœ›ä¸€è¦§</a></li>
      <li><a href="{{ url_for('makeshift.settings') }}">è¨­å®š</a></li>
    </ul>
  </nav>

  <div class="container">
    <h1>ğŸ›  å¿™ã—ã•ãƒ»å¿…è¦äººæ•°è¨­å®š</h1>
    <p style="color:#666; margin-bottom:20px;">æ™‚é–“å¸¯ã”ã¨ã«å¿…è¦ãªäººæ•°ã‚’å…¥åŠ›ã—ã¦ã€Œè¿½åŠ ã€ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚<br>â€»å„ã‚¨ãƒªã‚¢ã®æ™‚é–“ã¯è‡ªç”±ã«å¤‰æ›´ã§ãã¾ã™ã€‚</p>

    <div class="time-zone-grid">

      <div class="zone-card zone-morning">
        <div class="zone-title">â˜€ï¸ æœãƒ»é–‹åº—æº–å‚™</div>
        <form action="{{ url_for('makeshift.add_demand') }}" method="POST">
          <div style="display:flex; gap:10px;">
            <div class="form-row" style="flex:1;">
              <label>é–‹å§‹</label>
              <input type="time" name="start_time" value="09:00">
            </div>
            <div class="form-row" style="flex:1;">
              <label>çµ‚äº†</label>
              <input type="time" name="end_time" value="11:00">
            </div>
          </div>
          <div class="form-row">
            <label>å½¹å‰²</label>
            <select name="position_id">
                {% for pos in positions %}
                  <option value="{{ pos.id }}" {% if pos.id == 2 %}selected{% endif %}>{{ pos.name }}</option>
                {% endfor %}
            </select>
          </div>
          <div class="form-row">
            <label>äººæ•°</label>
            <input type="number" name="required_count" min="0" value="1">
          </div>
          <button type="submit" class="add-btn" style="background:#4caf50;">ï¼‹ æœã®è¨­å®šã‚’è¿½åŠ </button>
        </form>
      </div>

      <div class="zone-card zone-lunch">
        <div class="zone-title">ğŸ” æ˜¼ãƒ»ãƒ©ãƒ³ãƒãƒ”ãƒ¼ã‚¯</div>
        <form action="{{ url_for('makeshift.add_demand') }}" method="POST">
          <div style="display:flex; gap:10px;">
            <div class="form-row" style="flex:1;">
              <label>é–‹å§‹</label>
              <input type="time" name="start_time" value="11:30">
            </div>
            <div class="form-row" style="flex:1;">
              <label>çµ‚äº†</label>
              <input type="time" name="end_time" value="14:00">
            </div>
          </div>
          <div class="form-row">
            <label>å½¹å‰²</label>
            <select name="position_id">
                {% for pos in positions %}
                  <option value="{{ pos.id }}">{{ pos.name }}</option>
                {% endfor %}
            </select>
          </div>
          <div class="form-row">
            <label>äººæ•°</label>
            <input type="number" name="required_count" min="0" value="3">
          </div>
          <button type="submit" class="add-btn" style="background:#ff9800;">ï¼‹ æ˜¼ã®è¨­å®šã‚’è¿½åŠ </button>
        </form>
      </div>

      <div class="zone-card zone-idle">
        <div class="zone-title">â˜•ï¸ 15æ™‚ãƒ»ã‚¢ã‚¤ãƒ‰ãƒ«</div>
        <form action="{{ url_for('makeshift.add_demand') }}" method="POST">
          <div style="display:flex; gap:10px;">
            <div class="form-row" style="flex:1;">
              <label>é–‹å§‹</label>
              <input type="time" name="start_time" value="15:00">
            </div>
            <div class="form-row" style="flex:1;">
              <label>çµ‚äº†</label>
              <input type="time" name="end_time" value="17:00">
            </div>
          </div>
          <div class="form-row">
            <label>å½¹å‰²</label>
            <select name="position_id">
                {% for pos in positions %}
                  <option value="{{ pos.id }}">{{ pos.name }}</option>
                {% endfor %}
            </select>
          </div>
          <div class="form-row">
            <label>äººæ•°</label>
            <input type="number" name="required_count" min="0" value="1">
          </div>
          <button type="submit" class="add-btn" style="background:#9e9e9e;">ï¼‹ ä¼‘æ†©æ™‚é–“ã®è¨­å®šã‚’è¿½åŠ </button>
        </form>
      </div>

      <div class="zone-card zone-night">
        <div class="zone-title">ğŸ» å¤œãƒ»ãƒ‡ã‚£ãƒŠãƒ¼</div>
        <form action="{{ url_for('makeshift.add_demand') }}" method="POST">
          <div style="display:flex; gap:10px;">
            <div class="form-row" style="flex:1;">
              <label>é–‹å§‹</label>
              <input type="time" name="start_time" value="18:00">
            </div>
            <div class="form-row" style="flex:1;">
              <label>çµ‚äº†</label>
              <input type="time" name="end_time" value="22:00">
            </div>
          </div>
          <div class="form-row">
            <label>å½¹å‰²</label>
            <select name="position_id">
                {% for pos in positions %}
                  <option value="{{ pos.id }}">{{ pos.name }}</option>
                {% endfor %}
            </select>
          </div>
          <div class="form-row">
            <label>äººæ•°</label>
            <input type="number" name="required_count" min="0" value="4">
          </div>
          <button type="submit" class="add-btn" style="background:#3f51b5;">ï¼‹ å¤œã®è¨­å®šã‚’è¿½åŠ </button>
        </form>
      </div>

    </div>
    <div class="demand-list">
      <h3>ğŸ“Š ç¾åœ¨ä¿å­˜ã•ã‚Œã¦ã„ã‚‹è¨­å®šä¸€è¦§</h3>
      <div style="max-height: 300px; overflow-y: auto;">
        <table>
          <thead>
            <tr>
              <th>æ™‚é–“å¸¯</th>
              <th>å½¹å‰²</th>
              <th>å¿…è¦äººæ•°</th>
            </tr>
          </thead>
          <tbody>
            {% for d in demands %}
            <tr>
              <td>{{ d.time_slot }}</td>
              <td>
                {% if 'ã‚­ãƒƒãƒãƒ³' in d.position_name %}
                  <span style="color:#e91e63; font-weight:bold;">ğŸ³ {{ d.position_name }}</span>
                {% elif 'ãƒ›ãƒ¼ãƒ«' in d.position_name %}
                  <span style="color:#2196f3; font-weight:bold;">ğŸ›ï¸ {{ d.position_name }}</span>
                {% else %}
                  {{ d.position_name }}
                {% endif %}
              </td>
              <td><b>{{ d.required_count }}</b> å</td>
            </tr>
            {% else %}
            <tr><td colspan="3" style="text-align:center; color:#aaa;">è¨­å®šãŒã‚ã‚Šã¾ã›ã‚“</td></tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      <form action="{{ url_for('makeshift.reset_demand') }}" method="POST" style="margin-top:20px; text-align:right;">
        <button type="submit" class="btn" style="background:#d32f2f; color:white; padding:8px 16px; border:none; border-radius:4px; cursor:pointer;" onclick="return confirm('ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã‹ï¼Ÿ')">ğŸ—‘ å…¨ã¦å‰Šé™¤ã—ã¦ãƒªã‚»ãƒƒãƒˆ</button>
      </form>
    </div>
    
    <div style="margin-top:30px; text-align:center;">
        <a href="#" onclick="document.getElementById('basicSettings').style.display='block'; return false;" style="color:#666;">â–¼ åŸºæœ¬è¨­å®šï¼ˆé–‹åº—æ™‚é–“ãªã©ï¼‰ã‚’è¡¨ç¤º</a>
    </div>
    
    <div id="basicSettings" style="display:none; margin-top:20px; background:#f5f5f5; padding:20px; border-radius:8px;">
        <h3>åŸºæœ¬ãƒ«ãƒ¼ãƒ«è¨­å®š</h3>
        <form method="POST" action="{{ url_for('makeshift.settings') }}">
             <label>é–‹åº—ï¼š</label><input type="time" name="start_time" value="{{ settings.start_time }}">
             <label>é–‰åº—ï¼š</label><input type="time" name="end_time" value="{{ settings.end_time }}">
             <input type="hidden" name="max_hours_per_day" value="{{ settings.max_hours_per_day }}">
             <button type="submit">ä¿å­˜</button>
        </form>
    </div>

  </div>
</body>
</html>